# OTUS PRO Homework 12-Systemd

### Домашняя работа 12: Инициализация системы. Systemd
---
### Домашнее задание:
   - Написать service, который будет раз в 30 секунд мониторить лог на предмет наличия ключевого слова (файл лога и ключевое слово должны задаваться в /etc/default).  
   - Установить spawn-fcgi и создать unit-файл (spawn-fcgi.sevice) с помощью переделки init-скрипта (https://gist.github.com/cea2k/1318020).  
   - Доработать unit-файл Nginx (nginx.service) для запуска нескольких инстансов сервера с разными конфигурационными файлами одновременно.
---
### Выполнение задания:

### 1. Настройка рабочего стенда

Выполнение домашнего задания предполагает, что на компьютере установлен Vagrant+VirtualBox   

Развернем Vagrant-стенд:
  - Создайте папку с проектом и зайдите в нее (например: /otus_systemd):
```
mkdir -p otus_systemd ; cd ./otus_systemd
```
  - Клонируете проект с Github, набрав команду:
```
apt update -y && apt install git -y ; git clone https://github.com/pahami/otus_systemd.git
```
  - Запустите проект из папки, в которую склонировали проект (в нашем примере ./otus_systemd):
```
vagrant up
```
Результатом выполнения команды `vagrant up` станут 3 виртуальных машины:
 - watchlog - создание собственного сервиса
 - spawn - создание unit-файла (spawn-fcgi.sevice) с помощью переделки init-скрипта
 - nginx - запуск нескольких инстансов сервера с разными конфигурационными файлами одновременно


#### 1. Написать service, который будет раз в 30 секунд мониторить лог на предмет наличия ключевого слова (файл лога и ключевое слово должны задаваться в /etc/default).

Зайдите на созданную VM watchlog
```
vagrant ssh watchlog
```

<details>
<summary>проверить работу сервиса</summary>
- Что бы проверить работу сервиса, необходимо выполнить следующую команду на целевой машине:

```
tail -n 1000 /var/log/syslog  | grep word
```
</details>

---
#### 2. Установить spawn-fcgi и создать unit-файл (spawn-fcgi.sevice) с помощью переделки init-скрипта (https://gist.github.com/cea2k/1318020)

Зайдите на созданную VM fcgi
```
vagrant ssh watchlog
```

<details>
<summary>проверить работу сервиса</summary>
- Что бы проверить работу сервиса, необходимо выполнить следующую команду на целевой машине:

```
systemctl status spawn-fcgi
```
</details>

---
#### 3) Доработать unit-файл Nginx (nginx.service) для запуска нескольких инстансов сервера с разными конфигурационными файлами одновременно

Зайдите на созданную VM watchlog
```
vagrant ssh watchlog
```

<details>
<summary>проверить работу сервиса</summary>
- Что бы проверить работу сервиса, необходимо выполнить следующую команду на целевой машине:

```
systemctl status nginx@first
systemctl status nginx@second
```
</details>